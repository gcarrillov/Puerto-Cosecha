{% extends "base.html" %}

{% block title %}{{ producto.nombre }}{% endblock %}

{% block content %}
<h2>{{ producto.nombre }}</h2>

<p><strong>Productor:</strong> {{ producto.productor.user.username }}</p>
<p><strong>Descripción:</strong> {{ producto.descripcion }}</p>
<p><strong>Precio unitario:</strong> {{ producto.precio_unitario }}</p>
<p><strong>Stock:</strong> {{ producto.stock }}</p>
<p><strong>País de origen:</strong> {{ producto.pais_origen }}</p>

<hr>

{# Si es empresa logueada, puede solicitar operación #}
{% if user.is_authenticated and user.perfil.rol == 'empresa' %}
    <p>
        <a href="{% url 'crear_operacion' producto.pk %}">
            Solicitar operación comercial
        </a>
    </p>
{% elif not user.is_authenticated %}
    <p>
        Para solicitar una operación comercial, debes
        <a href="{% url 'login' %}?next={% url 'detalle_producto' producto.pk %}">iniciar sesión</a>.
    </p>
{% endif %}

{# Si es el productor dueño del producto, puede editarlo #}
{% if user.is_authenticated and user.perfil == producto.productor %}
    <p>
        <a href="{% url 'editar_producto' producto.pk %}">Editar este producto</a>
    </p>
{% endif %}

<a href="{% url 'lista_productos' %}">← Volver al listado</a>
{% endblock %}
