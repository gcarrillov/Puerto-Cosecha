<h2>Reporte Completo de Operaciones</h2>

<form method="get">
    <label for="estado">Estado:</label>
    <select name="estado" id="estado">
        <option value="">Todos</option>
        {% for e in estados %}
            <option value="{{ e }}" {% if e == estado_seleccionado %}selected{% endif %}>{{ e }}</option>
        {% endfor %}
    </select>

    <label for="pais">País:</label>
    <select name="pais" id="pais">
        <option value="">Todos</option>
        {% for p in paises %}
            <option value="{{ p }}" {% if p == pais_seleccionado %}selected{% endif %}>{{ p }}</option>
        {% endfor %}
    </select>

    <label for="producto">Producto:</label>
    <select name="producto" id="producto">
        <option value="">Todos</option>
        {% for id, nombre in productos %}
            <option value="{{ id }}" {% if id|stringformat:"s" == producto_seleccionado %}selected{% endif %}>{{ nombre }}</option>
        {% endfor %}
    </select>

    <button type="submit">Filtrar</button>
</form>

<table border="1" cellpadding="5" cellspacing="0">
    <thead>
        <tr>
            <th>Producto</th>
            <th>Estado</th>
            <th>País de destino</th>
            <th>Total Cantidad</th>
            <th>Total Operaciones</th>
        </tr>
    </thead>
    <tbody>
        {% for r in resumen %}
            <tr>
                <td>{{ r.producto__nombre }}</td>
                <td>{{ r.estado }}</td>
                <td>{{ r.pais_destino }}</td>
                <td>{{ r.total_cantidad }}</td>
                <td>{{ r.total_operaciones }}</td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="5">No hay operaciones que coincidan con los filtros.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
